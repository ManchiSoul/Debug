!function(s){"use strict";s.WS_Form.prototype.form_progress=function(){var a=this,e=this.get_field_value_fallback("progress",!1,"class_complete",[]);this.progress_class_complete=e.join(" ");var r=this.get_field_value_fallback("progress",!1,"class_incomplete",[]);this.progress_class_incomplete=r.join(" "),s("[data-required]:not([data-init-required])",this.form_canvas_obj).each(function(){var e=a.get_field(s(this)).type,r=s.WS_Form.field_type_cache[e].events.event;s(this).on(r,function(){a.form_progress_process()})}),s("[data-progress-include]:not([data-init-required])",this.form_canvas_obj).each(function(){var e=s(this).attr("data-progress-include");s(this).on(e,function(){a.form_progress_process()})}),s("[data-progress-bar]:not([data-source])",this.form_canvas_obj).each(function(){var e=s(this).attr("value");e=isNaN(e)||!e?0:parseFloat(e),a.form_progress_set_value(s(this),e)}),this.form_progress_process(),this.form_progress_api_call_reset()},s.WS_Form.prototype.form_progress_process=function(){var a=this,e=[],r=0,t=0;s("[data-required]:not([data-required-bypass],[data-required-bypass-section],[data-required-bypass-group])",this.form_canvas_obj).each(function(){var o=a.get_field(s(this)).type,i=a.get_section_repeatable_index(s(this)),_=i>0?"["+i+"]":"",n=ws_form_settings.field_prefix+a.get_field_id(s(this))+_,p=!1;switch(o){case"radio":case"price_radio":if(void 0!==e[n])return;p=s(this)[0].checkValidity();break;case"signature":"function"==typeof a.signature_get_response_by_name&&(p=a.signature_get_response_by_name(n));break;case"email":p=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s(this).val());break;default:p=s(this)[0].checkValidity()}p&&t++,e[n]=!0,r++}),s("[data-progress-include]:not([data-min-bypass],[data-min-bypass-section],[data-min-bypass-group],[data-max-bypass],[data-max-bypass-section],[data-max-bypass-group],[data-step-bypass])",this.form_canvas_obj).each(function(){s(this)[0].checkValidity()&&t++,r++});var o=r>0?t/r:0;s('[data-progress-bar][data-source="form_progress"], .wsf-form-conversational-nav-progress',this.form_canvas_obj).each(function(){a.form_progress_set_value(s(this),o)})},s.WS_Form.prototype.form_progress_set_value=function(a,e){var r=s("[data-progress-bar-value]",a);if(r.length||(r=a),a.is("progress"))if(a.attr("max")){var t=a.attr("max");t=isNaN(t)||!t?1:parseFloat(t)}else t=1;else t=1;t<=0&&(t=1),e<0&&(e=0),e>t&&(e=t);var o=Math.round(e/t*100);if(a.is("progress")){var i=r.val()!=e;r.val(e),i&&r.trigger("change"),a.attr("aria-valuemin",0).attr("aria-valuemax",t).attr("aria-valuenow",e)}else{i=r.attr("data-value")!=e;r.attr("data-value",e).css("width",o+"%"),i&&r.trigger("change"),void 0!==a.attr("aria-valuenow")&&a.attr("aria-valuenow",e),void 0!==r.attr("aria-valuenow")&&r.attr("aria-valuenow",e)}if(100==o?(a.addClass(this.progress_class_complete),a.removeClass(this.progress_class_incomplete)):(a.removeClass(this.progress_class_complete),a.addClass(this.progress_class_incomplete)),this.conversational&&a.hasClass("wsf-form-conversational-nav-progress"))var _=s(".wsf-form-conversational-nav-progress-help",this.form_canvas_obj),n=this.get_object_meta_value(this.form,"conversational_nav_progress_help","#progress_percent",!1,!1);else{var p=this.get_field(a);n=this.get_object_meta_value(p,"help","#progress_percent",!1,!1),_=this.get_help_obj(a)}if(_.length&&-1!==n.indexOf("#progress")){var c={progress_remaining_percent:100-o+"%",progress_remaining:100-o,progress_percent:o+"%",progress:o},l=this.mask_parse(n,c);l=this.parse_variables_process(l).output,_.html(l)}},s.WS_Form.prototype.form_progress_tabs=function(){var a=this,e=s(".wsf-group-tabs",this.form_canvas_obj).children(":not([data-wsf-group-hidden])"),r=e.length,t=void 0!==this.framework.tabs.public.class_active?this.framework.tabs.public.class_active:"active",o=1;e.each(function(){if(s(this).hasClass(t))return!1;o++});var i=o/r;s('[data-source="tab_progress"]',this.form_canvas_obj).each(function(){a.form_progress_set_value(s(this),i)})},s.WS_Form.prototype.form_progress_api_call_reset=function(){var a=this;s('[data-progress-bar][data-source="post_progress"]',this.form_canvas_obj).each(function(){a.form_progress_set_value(s(this),0)})},s.WS_Form.prototype.form_progress_api_call=function(a,e){if(e.lengthComputable){var r=this;a.each(function(){var a=e.loaded/e.total;r.form_progress_set_value(s(this),a)})}}}(jQuery);